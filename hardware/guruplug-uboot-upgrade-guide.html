<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GuruPlug: uBoot upgrade guide &mdash; Hackzine Wiki</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Hackzine Wiki" href="../index.html" />
    <link rel="up" title="Hardware" href="index.html" />
    <link rel="next" title="Scripts" href="../scripts/index.html" />
    <link rel="prev" title="GuruPlug: misc stuff" href="guruplug-misc.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../scripts/index.html" title="Scripts"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="guruplug-misc.html" title="GuruPlug: misc stuff"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Hackzine Wiki</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Hardware</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            

  <div class="section" id="guruplug-uboot-upgrade-guide">
<h1>GuruPlug: uBoot upgrade guide<a class="headerlink" href="#guruplug-uboot-upgrade-guide" title="Permalink to this headline">Â¶</a></h1>
<p>See also the full guide here: <a class="reference internal" href="guruplug-misc.html"><em>GuruPlug: misc stuff</em></a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a mirror copy of <a class="reference external" href="http://www.cyrius.com/debian/kirkwood/sheevaplug/uboot-upgrade.html">Upgrading SheevaPlug&#8217;s U-Boot</a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To access the uBoot console: connect the GuruPlug serial port to your
computer and start console, then power up the plug.
You&#8217;ll see a message saying to press a key to enter uboot console: do that.</p>
</div>
<p>This page describes how to install a new version of U-Boot on your plug computer.
U-Boot is the boot loader used on plug computers.</p>
<p>First of all, check which version of U-Boot is installed on your plug computer
to find out whether you have to perform this upgrade.</p>
<p>Connect to U-Boot using the serial console and type:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">version</span>
</pre></div>
</div>
<p>This will show the version of U-Boot on your plug computer.
Two different (and slightly incompatible) variants of U-Boot are commonly
used on plug computers. When Marvell introduced the first plug computers a few
years ago, they created their own variant of U-Boot to add support for plug
computers.
This work has been integrated into the official U-Boot variant in the meantime.
The advantages of the official U-Boot variant (sometimes known as DENX) is that
it is much more rapidly developed and therefore offers features and bug fixes
not found in the Marvell variant. We will use the DENX variant.</p>
<p>When you type version in U-Boot, you can easily spot if you&#8217;re using the
Marvell version. It shows the U-Boot version 1.1.4 plus a separate Marvell
version, as in this example:</p>
<div class="highlight-python"><div class="highlight"><pre>U-Boot 1.1.4 (Dec 27 2009 - 22:03:21) Marvell version: 3.4.27
</pre></div>
</div>
<p>On the other hand, the version string of the DENX variant looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre>U-Boot 2011.12 (Mar 11 2012 - 18:59:46)
</pre></div>
</div>
<p>In other words, U-Boot is followed by a date and there is no Marvell version.</p>
<p>If your plug computer is using the Marvell variant of U-Boot, you have to
upgrade since the installation guide assumes that you&#8217;re using the DENX variant.
If you&#8217;re already using the DENX variant, you can upgrade in case your U-Boot
is older than the one above (i.e. older than 2011.12).</p>
<p>If you&#8217;re upgrading from the Marvell to the DENX variant, issue the following
command and write down your MAC address. This step is important because all
U-Boot configuration data (including your MAC address) is lost when upgrading
from the Marvell to the DENX U-Boot.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">ethaddr</span>
</pre></div>
</div>
<p>Obtain the U-Boot binary for your device and save it as u-boot.kwb.
Please note that since the boot loader interacts with the hardware, you have
to use the correct u-boot binary for your device. If your device is not listed
on this page, it is not safe to use another u-boot binary listed here!</p>
<ul class="simple">
<li><a class="reference external" href="http://people.debian.org/~tbm/u-boot/2011.12-3/sheevaplug/u-boot.kwb">SheevaPlug</a> (the original SheevaPlug, the eSATA SheevaPlug and the Ionics Nimbus 100)</li>
<li><a class="reference external" href="http://people.debian.org/~tbm/u-boot/2011.12-3/guruplug/u-boot.kwb">GuruPlug</a> (GuruPlug Server Standard and GuruPlug Server Plus)</li>
<li><a class="reference external" href="http://people.debian.org/~tbm/u-boot/2011.12-3/dockstar/u-boot.kwb">Seagate FreeAgent DockStar</a></li>
</ul>
<p>There are different ways to upgrade U-Boot on your plug computer:</p>
<p><strong>USB:</strong> First of all, copy the U-Boot binary u-boot.kwb to a USB stick
formated with the FAT filesystem. Then plug the USB stick into your plug
computer, connect the serial console and type the following commands:</p>
<div class="highlight-python"><div class="highlight"><pre>usb start
fatload usb 0:1 0x0800000 u-boot.kwb
nand erase 0x0 0x60000
nand write 0x0800000 0x0 0x60000
</pre></div>
</div>
<p><strong>TFTP:</strong> If you have a TFTP server, copy the file u-boot.kwb to your TFTP
server. Then start your plug computer, connect the serial console and type the
following commands:</p>
<div class="highlight-python"><div class="highlight"><pre>setenv serverip 192.168.1.2 # IP of your TFTP server
setenv ipaddr 192.168.1.200
tftpboot 0x0800000 u-boot.kwb
nand erase 0x0 0x60000
nand write 0x0800000 0x0 0x60000
</pre></div>
</div>
<p>Regardless of how you installed U-Boot, you now have to restart your machine
to load the new version of U-Boot:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">reset</span>
</pre></div>
</div>
<p>If you upgraded from the Marvell to the DENX variant, you now have to set your
MAC address (replace the MAC address in the example with the one you wrote down
before):</p>
<div class="highlight-python"><div class="highlight"><pre>setenv ethaddr 00:50:43:01:c0:ab
saveenv
reset
</pre></div>
</div>
<p>Finally, if you have an eSATA SheevaPlug, you have to change some settings in
u-boot so the device will boot the correct kernel for your device.
This step is only required on the eSATA SheevaPlug and not on other plug
computers. If you have an eSATA SheevaPlug, type:</p>
<div class="highlight-python"><div class="highlight"><pre>setenv machid a76
saveenv
reset
</pre></div>
</div>
<p>These commands will put in the correct settings and then restart the device
so the changes will take effect.</p>
<p>Go back to my <a class="reference external" href="http://www.cyrius.com/debian/kirkwood/sheevaplug/index.html">Debian on Plug Computer</a> page.</p>
</div>


    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'hackzinewiki'; // required: replace example with your forum shortname
        var disqus_identifier = "hardware/guruplug-uboot-upgrade-guide";
	var disqus_title = "Hackzine Wiki";

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="guruplug-misc.html"
                        title="previous chapter">GuruPlug: misc stuff</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../scripts/index.html"
                        title="next chapter">Scripts</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/hardware/guruplug-uboot-upgrade-guide.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../scripts/index.html" title="Scripts"
             >next</a> |</li>
        <li class="right" >
          <a href="guruplug-misc.html" title="GuruPlug: misc stuff"
             >previous</a> |</li>
        <li><a href="../index.html">Hackzine Wiki</a> &raquo;</li>
          <li><a href="index.html" >Hardware</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012-2014, Samuele ~redShadow~ Santi.
      Last updated on 2014-03-01 00:28:30 +0100.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>