<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Linux: dump NVIDIA card settings &mdash; Hackzine Wiki</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Hackzine Wiki" href="../index.html" />
    <link rel="up" title="Sysadmin" href="index.html" />
    <link rel="next" title="Linux: Basic LUKS usage" href="linux-using-luks.html" />
    <link rel="prev" title="Linux: Resizing a LUKS volume on LVM" href="linux-lvm-luks-resize.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="linux-using-luks.html" title="Linux: Basic LUKS usage"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="linux-lvm-luks-resize.html" title="Linux: Resizing a LUKS volume on LVM"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Hackzine Wiki</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Sysadmin</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            

  <div class="section" id="linux-dump-nvidia-card-settings">
<h1>Linux: dump NVIDIA card settings<a class="headerlink" href="#linux-dump-nvidia-card-settings" title="Permalink to this headline">Â¶</a></h1>
<p>This is an <strong>experimental</strong> script that tries to dump the current monitors
configuration for nvidia video cards on Linux.</p>
<p>What it does, is to print a script to be used to restore the current video
metamode, and set appropriate screen resolution using xrandr.
It is untested with complex configurations, involving xinerama and more than
two active monitors at once.</p>
<p>Some ideas come from <a class="reference external" href="http://ubuntuforums.org/showthread.php?t=1558492">http://ubuntuforums.org/showthread.php?t=1558492</a></p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#!/bin/bash</span>

<span class="c">##----------------------------------------------------------------------</span>
<span class="c">## Tries to dump settings for nvidia video cards.</span>
<span class="c">##</span>
<span class="c">## WARNING! this is experimental software - USE AT YOUR ONW RISK</span>
<span class="c">##</span>
<span class="c">## Author: Samuele ~redShadow~ Santi &lt;redshadow@hackzine.org&gt;</span>
<span class="c">## License: Under GPL v2 or newer</span>
<span class="c">##----------------------------------------------------------------------</span>

<span class="k">if</span> ! which nv-control-dpy &amp;&gt;/dev/null; <span class="k">then</span>
<span class="k">    </span><span class="nb">echo</span> <span class="s2">&quot;nv-control-dpy is required, but was not found!&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot;This is usually contained in the &#39;nvidia-settings&#39; package.&quot;</span>
    <span class="nb">exit </span>1
<span class="k">fi</span>

<span class="k">if</span> ! which xrandr &amp;&gt;/dev/null; <span class="k">then</span>
<span class="k">    </span><span class="nb">echo</span> <span class="s2">&quot;xrandr is required, but was not found!&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot;This is usually contained in the &#39;x11-xserver-utils&#39; package.&quot;</span>
    <span class="nb">exit </span>1
<span class="k">fi</span>

<span class="nb">echo</span> <span class="s1">&#39;#!/bin/sh&#39;</span>
<span class="nb">echo</span> <span class="s2">&quot;## Autogenerated on $( date +&#39;%F %H:%M&#39; )&quot;</span>
<span class="nb">echo</span> <span class="s1">&#39;nv-control-dpy --set-associated-dpys &#39;</span><span class="s2">&quot;$( nv-control-dpy --get-associated-dpys | grep &quot;</span>^associated display device mask:<span class="s2">&quot; | sed &quot;</span>s/.*:<span class="se">\s</span>*//<span class="s2">&quot; )&quot;</span>
<span class="nb">echo</span> <span class="s1">&#39;nv-control-dpy --add-metamode &quot;&#39;</span><span class="s2">&quot;$( nv-control-dpy --print-current-metamode | grep &quot;</span>^current metamode:<span class="s2">&quot; | sed &#39;s/.*&quot;</span>.*::<span class="se">\s</span>*<span class="se">\(</span>.*<span class="se">\)</span><span class="s2">&quot;/\1/&#39; )&quot;</span><span class="s1">&#39;&quot;&#39;</span>
xrandr 2&gt;/dev/null | grep <span class="s2">&quot;^\s\+\([0-9]\+x[0-9]\+\)\(\s\+[0-9]\+\.[0-9]\+\)\+\*\s*\$&quot;</span> | sed <span class="s2">&quot;s/^\s\+\([0-9]\+x[0-9]\+\)\(\s\+\([0-9]\+\.[0-9]\+\)\)\+\*\s*\$/xrandr -s \1 -r \3/&quot;</span>
</pre></div>
</div>
<p>Usually, the generated output will look like this:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#!/bin/sh</span>
<span class="c">## Autogenerated on 2012-04-23 13:11</span>
nv-control-dpy --set-associated-dpys 0x000d0000
nv-control-dpy --add-metamode <span class="s2">&quot;DFP-2: 1920x1200 @1920x1200 +1920+0, DFP-3: nvidia-auto-select @1920x1200 +0+0, DFP-0: NULL&quot;</span>
xrandr -s 3840x1200 -r 51.0
</pre></div>
</div>
</div>


    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'hackzinewiki'; // required: replace example with your forum shortname
        var disqus_identifier = "sysadmin/linux-nvidia-dump-settings";
	var disqus_title = "Hackzine Wiki";

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="linux-lvm-luks-resize.html"
                        title="previous chapter">Linux: Resizing a LUKS volume on LVM</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="linux-using-luks.html"
                        title="next chapter">Linux: Basic LUKS usage</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/sysadmin/linux-nvidia-dump-settings.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="linux-using-luks.html" title="Linux: Basic LUKS usage"
             >next</a> |</li>
        <li class="right" >
          <a href="linux-lvm-luks-resize.html" title="Linux: Resizing a LUKS volume on LVM"
             >previous</a> |</li>
        <li><a href="../index.html">Hackzine Wiki</a> &raquo;</li>
          <li><a href="index.html" >Sysadmin</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012-2014, Samuele ~redShadow~ Santi.
      Last updated on 2014-02-13 16:46:02 +0100.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>